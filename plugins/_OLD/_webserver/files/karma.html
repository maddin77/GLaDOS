<!DOCTYPE html>
<html>
    <head>
        <title>James â€¢ Karma</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <style type="text/css">{%css%}</style>
        <script type="text/javascript">{%jquery%}</script>
        <script type="text/javascript">{%bootstrapjs%}</script>
        <link href="data:image/x-icon;base64,AAABAAEAEBAQAAAAAAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQEBAAICAwACAwQAAgMDAAMDAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAQAAAABQAAAAAAUAADAEAgBQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA4YcAAMADAADYGwAA/D8AAP//AAD//wAA//8AAP//AAD//wAA" rel="shortcut icon" />
    </head>
    <body>
        <div class="container">
            <div class="row main">
                <div class="navbar navbar-static-top">
                    <div class="navbar-inner">
                        <ul class="nav">
                            <li><a href="/quiz">Quiz Score</a></li>
                            <li class="active"><a href="/karma">Karma</a></li>
                            <li><a href="/user">User</a></li>
                            <li><a href="/channel">Channel</a></li>
                        </ul>
                        <ul class="nav pull-right">
                            <li><a href="" id="timer">Data cached for <strong>{%CACHEDFOR%}</strong> sec. Next update in <b>{%CACHEDFOR%}.0</b> sec.</a></li>
                        </ul>
                    </div>
                </div>
                <div class="content">
                    <table id="score" class="table table-striped table-bordered table-hover"></table>
                </div>
            </div>
        </div>
        <script type="text/javascript">
        $(function() {
            var karma = {%KARMADATA%}, data = "<thead><th>Nick</th><th>Karma</th></thead><tbody>";
            karma.sort(function(a,b) {
                if(a.value > b.value) return -1;
                if(a.value == b.value) return 0;
                if(a.value < b.value) return 1;
            });
            for(var i=0; i<karma.length; i++) {
                var nick = karma[i].nick.replace(/</g, "&lt;").replace(/>/g, "&gt;");
                data += "<tr><td><a href='/user/" + nick + "'>" + nick + "</a>" + "</td><td>" + karma[i].value + "</td></tr>";
            }
            data += "</tbody>";
            $('#score').html(data);
        });
        </script>
        <script type="text/javascript">
        $(function() {
            var time = new Date("{%TIME%}").getTime();
            var cached = {%CACHEDFOR%};
            setInterval(function() {
                var diff = ((cached*1000) - (new Date().getTime() - time)) / 1000;
                $('#timer b').html(diff.toFixed(1));
                $('#timer strong').html(cached);
                if(diff <= 0) {
                    time = new Date();
                }
            }, 100);
        });
        </script>
    </body>
</html>